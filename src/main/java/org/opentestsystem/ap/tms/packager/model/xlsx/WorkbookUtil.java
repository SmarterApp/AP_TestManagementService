package org.opentestsystem.ap.tms.packager.model.xlsx;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.DataFormatter;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.util.CellReference;

import java.util.Optional;

public class WorkbookUtil {
    public static final DataFormatter FORMATTER = new DataFormatter();

    public static Optional<CellReference> getCellTypeString(final Sheet sheet, final String value) {
        for (final Row row : sheet) {
            for (final Cell cell : row) {
                if (FORMATTER.formatCellValue(cell).equals(value)) {
                    return Optional.of(new CellReference(row.getRowNum(), cell.getColumnIndex()));
                }
            }
        }
        return Optional.empty();
    }
}