package org.opentestsystem.ap.tms.packager.util;

import lombok.extern.slf4j.Slf4j;
import org.apache.commons.lang3.StringUtils;
import org.opentestsystem.ap.common.management.ItemManager;
import org.opentestsystem.ap.common.model.AssessmentItem;
import org.springframework.stereotype.Component;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Slf4j
@Component
public class ItemUtil {

    private ItemManager itemManager;

    public ItemUtil(ItemManager itemManager) {
        this.itemManager = itemManager;
    }

    /**
     * Reads item data from the database and populates a map
     *
     * @param itemIds
     * @return
     */
    public Map<String, AssessmentItem> getItemMetaData(List<String> itemIds) {
        final HashMap<String, AssessmentItem> timsItems = new HashMap<>();

        itemIds.forEach(itemId -> {
            if (StringUtils.isNotBlank(itemId)) {
                timsItems.put(itemId, (AssessmentItem) itemManager.findCurrentItem(itemId));
            }
        });

        return timsItems;
    }
}